# Tasks: Smart Trading Alerts

## Phase 1: 核心功能（优先级最高）

### 1. 提醒管理器和通知服务

- [ ] 1.1 创建 AlertManager 类
  - [ ] 1.1.1 实现 addRule 方法
  - [ ] 1.1.2 实现 removeRule 方法
  - [ ] 1.1.3 实现 updateRule 方法
  - [ ] 1.1.4 实现 getRules 方法
  - [ ] 1.1.5 实现 startMonitoring 方法
  - [ ] 1.1.6 实现 checkRules 方法（定时检查）
  - [ ] 1.1.7 实现 evaluateCondition 方法
  - [ ] 1.1.8 实现 triggerAlert 方法
  - [ ] 1.1.9 实现 localStorage 持久化

- [ ] 1.2 创建 NotificationService 类
  - [ ] 1.2.1 实现 requestPermission 方法
  - [ ] 1.2.2 实现 sendBrowserNotification 方法
  - [ ] 1.2.3 实现 playSound 方法（Web Audio API）
  - [ ] 1.2.4 实现 checkPermission 方法
  - [ ] 1.2.5 实现 showInternalMessage 方法
  - [ ] 1.2.6 处理通知点击事件（跳转到股票详情）

- [ ] 1.3 扩展 localStorage 工具
  - [ ] 1.3.1 添加 ALERT_RULES 存储键
  - [ ] 1.3.2 添加 ALERT_HISTORY 存储键
  - [ ] 1.3.3 添加 NOTIFICATION_SETTINGS 存储键
  - [ ] 1.3.4 实现 getAlertRules 函数
  - [ ] 1.3.5 实现 saveAlertRules 函数
  - [ ] 1.3.6 实现 getAlertHistory 函数
  - [ ] 1.3.7 实现 addAlertHistory 函数
  - [ ] 1.3.8 实现 clearOldHistory 函数（保留最近100条）

### 2. 价格提醒功能

- [ ] 2.1 创建 AlertCenter 组件
  - [ ] 2.1.1 实现组件基础结构
  - [ ] 2.1.2 实现提醒列表展示
  - [ ] 2.1.3 实现按类型分类（Tabs）
  - [ ] 2.1.4 实现添加提醒按钮
  - [ ] 2.1.5 实现删除提醒功能
  - [ ] 2.1.6 实现暂停/恢复提醒功能
  - [ ] 2.1.7 实现提醒历史查看

- [ ] 2.2 创建 AddAlertDialog 组件
  - [ ] 2.2.1 实现对话框基础结构
  - [ ] 2.2.2 实现股票选择（输入代码或搜索）
  - [ ] 2.2.3 实现目标价格输入
  - [ ] 2.2.4 实现方向选择（上涨/下跌）
  - [ ] 2.2.5 实现有效期设置
  - [ ] 2.2.6 实现通知渠道选择
  - [ ] 2.2.7 实现表单验证
  - [ ] 2.2.8 实现提交功能

- [ ] 2.3 集成价格提醒到主应用
  - [ ] 2.3.1 在 App.tsx 中初始化 AlertManager
  - [ ] 2.3.2 在 App.tsx 中初始化 NotificationService
  - [ ] 2.3.3 启动提醒监控
  - [ ] 2.3.4 添加 AlertCenter 到导航菜单
  - [ ] 2.3.5 实现首次使用时请求通知权限

### 3. 持仓追踪功能

- [ ] 3.1 创建 PortfolioManager 类
  - [ ] 3.1.1 实现 addPosition 方法
  - [ ] 3.1.2 实现 removePosition 方法
  - [ ] 3.1.3 实现 updatePositions 方法
  - [ ] 3.1.4 实现 getPositions 方法
  - [ ] 3.1.5 实现 getStatistics 方法
  - [ ] 3.1.6 实现 checkStopLossTakeProfit 方法
  - [ ] 3.1.7 实现 startAutoUpdate 方法（每30秒）
  - [ ] 3.1.8 实现 localStorage 持久化
  - [ ] 3.1.9 集成智能交易计划（v4.11.0）

- [ ] 3.2 扩展 localStorage 工具
  - [ ] 3.2.1 添加 PORTFOLIO_POSITIONS 存储键
  - [ ] 3.2.2 实现 getPositions 函数
  - [ ] 3.2.3 实现 savePositions 函数
  - [ ] 3.2.4 实现 addPosition 函数
  - [ ] 3.2.5 实现 removePosition 函数

- [ ] 3.3 创建 PortfolioTracker 组件
  - [ ] 3.3.1 实现组件基础结构
  - [ ] 3.3.2 实现持仓统计卡片
  - [ ] 3.3.3 实现持仓列表表格
  - [ ] 3.3.4 实现添加持仓对话框
  - [ ] 3.3.5 实现删除持仓功能
  - [ ] 3.3.6 实现持仓详情查看
  - [ ] 3.3.7 实现盈亏颜色标识
  - [ ] 3.3.8 实现持仓风险评估（集成v4.9.0）

- [ ] 3.4 创建 AddPositionDialog 组件
  - [ ] 3.4.1 实现对话框基础结构
  - [ ] 3.4.2 实现股票选择
  - [ ] 3.4.3 实现买入价格输入
  - [ ] 3.4.4 实现买入数量输入
  - [ ] 3.4.5 实现买入日期选择
  - [ ] 3.4.6 自动计算止损/止盈价（基于v4.11.0）
  - [ ] 3.4.7 实现表单验证
  - [ ] 3.4.8 实现提交功能

- [ ] 3.5 集成持仓追踪到主应用
  - [ ] 3.5.1 在 App.tsx 中初始化 PortfolioManager
  - [ ] 3.5.2 启动持仓自动更新
  - [ ] 3.5.3 添加 PortfolioTracker 到导航菜单
  - [ ] 3.5.4 实现持仓数据与提醒系统联动

---

## Phase 2: 自选股和技术指标（优先级高）

### 4. 自选股监控功能

- [ ] 4.1 创建 WatchListManager 类
  - [ ] 4.1.1 实现 addStock 方法
  - [ ] 4.1.2 实现 removeStock 方法
  - [ ] 4.1.3 实现 removeMultiple 方法
  - [ ] 4.1.4 实现 getStocks 方法
  - [ ] 4.1.5 实现 updateStocks 方法
  - [ ] 4.1.6 实现 checkAbnormal 方法
  - [ ] 4.1.7 实现 checkBuySignals 方法
  - [ ] 4.1.8 实现 startMonitoring 方法（每5分钟）
  - [ ] 4.1.9 实现 localStorage 持久化

- [ ] 4.2 扩展 localStorage 工具
  - [ ] 4.2.1 添加 WATCHLIST_STOCKS 存储键
  - [ ] 4.2.2 实现 getWatchList 函数
  - [ ] 4.2.3 实现 saveWatchList 函数
  - [ ] 4.2.4 实现 addToWatchList 函数
  - [ ] 4.2.5 实现 removeFromWatchList 函数

- [ ] 4.3 创建 WatchListPanel 组件
  - [ ] 4.3.1 实现组件基础结构
  - [ ] 4.3.2 实现自选股列表展示
  - [ ] 4.3.3 实现添加自选股功能
  - [ ] 4.3.4 实现删除自选股功能
  - [ ] 4.3.5 实现批量删除功能
  - [ ] 4.3.6 实现排序功能（涨跌幅/量比/市值）
  - [ ] 4.3.7 实现监控开关（异动/信号）
  - [ ] 4.3.8 实现导出自选股列表
  - [ ] 4.3.9 实现从筛选结果快速添加

- [ ] 4.4 集成自选股到主应用
  - [ ] 4.4.1 在 App.tsx 中初始化 WatchListManager
  - [ ] 4.4.2 启动自选股监控
  - [ ] 4.4.3 添加 WatchListPanel 到导航菜单
  - [ ] 4.4.4 在股票卡片添加"加入自选"按钮
  - [ ] 4.4.5 实现自选股与提醒系统联动

### 5. 技术指标分析功能

- [ ] 5.1 创建 IndicatorCalculator 类
  - [ ] 5.1.1 实现 calculateEMA 方法
  - [ ] 5.1.2 实现 calculateMACD 方法
  - [ ] 5.1.3 实现 calculateKDJ 方法
  - [ ] 5.1.4 实现 calculateRSI 方法
  - [ ] 5.1.5 实现 calculateSingleRSI 方法
  - [ ] 5.1.6 实现 analyzeTechnicals 方法
  - [ ] 5.1.7 实现 calculateConfidence 方法
  - [ ] 5.1.8 实现 generateRecommendation 方法

- [ ] 5.2 创建 TechnicalIndicators 组件
  - [ ] 5.2.1 实现组件基础结构
  - [ ] 5.2.2 实现综合信号展示
  - [ ] 5.2.3 实现 MACD 指标展示
  - [ ] 5.2.4 实现 KDJ 指标展示
  - [ ] 5.2.5 实现 RSI 指标展示
  - [ ] 5.2.6 实现信号颜色和图标
  - [ ] 5.2.7 实现小白友好的说明文字
  - [ ] 5.2.8 实现帮助文档链接

- [ ] 5.3 集成技术指标图表
  - [ ] 5.3.1 安装 lightweight-charts 库
  - [ ] 5.3.2 创建 MACDChart 组件
  - [ ] 5.3.3 创建 KDJChart 组件
  - [ ] 5.3.4 创建 RSIChart 组件
  - [ ] 5.3.5 实现图表数据加载
  - [ ] 5.3.6 实现图表交互（缩放、拖动）

- [ ] 5.4 集成技术指标到股票详情
  - [ ] 5.4.1 在 StockDetail 组件添加技术指标标签页
  - [ ] 5.4.2 实现技术指标数据加载
  - [ ] 5.4.3 实现技术指标缓存（避免重复计算）
  - [ ] 5.4.4 实现技术指标刷新功能

---

## Phase 3: 智能推荐和设置（优先级中）

### 6. 智能推荐功能

- [ ] 6.1 实现每日推荐
  - [ ] 6.1.1 创建 DailyRecommendation 组件
  - [ ] 6.1.2 实现开盘后30分钟自动筛选
  - [ ] 6.1.3 实现推荐通知发送
  - [ ] 6.1.4 实现推荐理由展示
  - [ ] 6.1.5 实现用户接收时间设置

- [ ] 6.2 实现板块轮动提醒
  - [ ] 6.2.1 集成板块轮动分析（v4.10.0）
  - [ ] 6.2.2 检测连续3天资金流入的板块
  - [ ] 6.2.3 发送板块轮动通知
  - [ ] 6.2.4 推荐板块内优质股票
  - [ ] 6.2.5 生成板块分析报告

- [ ] 6.3 实现市场情绪提醒
  - [ ] 6.3.1 集成市场情绪指数（v4.11.0）
  - [ ] 6.3.2 检测极度恐慌（<20分）
  - [ ] 6.3.3 检测极度乐观（>80分）
  - [ ] 6.3.4 发送情绪提醒通知
  - [ ] 6.3.5 检测情绪反转信号

- [ ] 6.4 实现策略表现提醒
  - [ ] 6.4.1 集成历史表现追踪（v4.11.0）
  - [ ] 6.4.2 实现每周策略报告
  - [ ] 6.4.3 检测胜率下降
  - [ ] 6.4.4 发送策略表现通知
  - [ ] 6.4.5 提供改进建议

### 7. 提醒设置功能

- [ ] 7.1 创建 NotificationSettings 组件
  - [ ] 7.1.1 实现组件基础结构
  - [ ] 7.1.2 实现总开关
  - [ ] 7.1.3 实现分类开关（价格/持仓/自选股/推荐）
  - [ ] 7.1.4 实现交易时段设置
  - [ ] 7.1.5 实现每日最大提醒数量设置
  - [ ] 7.1.6 实现提醒间隔设置
  - [ ] 7.1.7 实现通知渠道选择
  - [ ] 7.1.8 实现免打扰模式
  - [ ] 7.1.9 实现设置保存和加载

- [ ] 7.2 实现提醒历史
  - [ ] 7.2.1 创建 AlertHistory 组件
  - [ ] 7.2.2 实现历史记录列表
  - [ ] 7.2.3 实现按类型筛选
  - [ ] 7.2.4 实现按日期筛选
  - [ ] 7.2.5 实现已读/未读标记
  - [ ] 7.2.6 实现清空历史功能
  - [ ] 7.2.7 实现历史记录详情查看

- [ ] 7.3 集成提醒设置到主应用
  - [ ] 7.3.1 添加 NotificationSettings 到导航菜单
  - [ ] 7.3.2 实现设置与 AlertManager 联动
  - [ ] 7.3.3 实现设置与 NotificationService 联动
  - [ ] 7.3.4 实现设置实时生效

---

## Phase 4: 测试和优化（优先级中）

### 8. 单元测试

- [ ] 8.1 AlertManager 测试
  - [ ] 8.1.1 测试添加规则
  - [ ] 8.1.2 测试删除规则
  - [ ] 8.1.3 测试更新规则
  - [ ] 8.1.4 测试规则检查
  - [ ] 8.1.5 测试条件评估
  - [ ] 8.1.6 测试提醒触发

- [ ] 8.2 PortfolioManager 测试
  - [ ] 8.2.1 测试添加持仓
  - [ ] 8.2.2 测试删除持仓
  - [ ] 8.2.3 测试盈亏计算
  - [ ] 8.2.4 测试统计计算
  - [ ] 8.2.5 测试止损止盈检查

- [ ] 8.3 WatchListManager 测试
  - [ ] 8.3.1 测试添加自选股
  - [ ] 8.3.2 测试删除自选股
  - [ ] 8.3.3 测试异动检测
  - [ ] 8.3.4 测试买入信号检测

- [ ] 8.4 IndicatorCalculator 测试
  - [ ] 8.4.1 测试 MACD 计算
  - [ ] 8.4.2 测试 KDJ 计算
  - [ ] 8.4.3 测试 RSI 计算
  - [ ] 8.4.4 测试综合分析

### 9. 集成测试

- [ ] 9.1 提醒流程测试
  - [ ] 9.1.1 测试价格提醒触发
  - [ ] 9.1.2 测试止损止盈提醒
  - [ ] 9.1.3 测试异动提醒
  - [ ] 9.1.4 测试买入信号提醒

- [ ] 9.2 持仓流程测试
  - [ ] 9.2.1 测试添加持仓流程
  - [ ] 9.2.2 测试持仓更新流程
  - [ ] 9.2.3 测试持仓删除流程

- [ ] 9.3 自选股流程测试
  - [ ] 9.3.1 测试添加自选股流程
  - [ ] 9.3.2 测试自选股监控流程
  - [ ] 9.3.3 测试自选股删除流程

### 10. 性能优化

- [ ] 10.1 定时任务优化
  - [ ] 10.1.1 优化提醒检查频率
  - [ ] 10.1.2 优化持仓更新频率
  - [ ] 10.1.3 优化自选股监控频率
  - [ ] 10.1.4 避免任务冲突

- [ ] 10.2 数据缓存优化
  - [ ] 10.2.1 实现股票数据缓存
  - [ ] 10.2.2 实现技术指标缓存
  - [ ] 10.2.3 实现缓存过期机制

- [ ] 10.3 通知优化
  - [ ] 10.3.1 实现通知节流
  - [ ] 10.3.2 实现通知合并
  - [ ] 10.3.3 实现通知优先级

- [ ] 10.4 localStorage 优化
  - [ ] 10.4.1 实现定期清理过期数据
  - [ ] 10.4.2 限制历史记录数量
  - [ ] 10.4.3 实现数据压缩

---

## Phase 5: 文档和发布（优先级低）

### 11. 文档编写

- [ ] 11.1 用户文档
  - [ ] 11.1.1 编写功能介绍
  - [ ] 11.1.2 编写使用指南
  - [ ] 11.1.3 编写常见问题
  - [ ] 11.1.4 编写技术指标说明

- [ ] 11.2 开发文档
  - [ ] 11.2.1 编写架构说明
  - [ ] 11.2.2 编写API文档
  - [ ] 11.2.3 编写扩展指南

### 12. 发布准备

- [ ] 12.1 版本发布
  - [ ] 12.1.1 更新版本号到 v4.12.0
  - [ ] 12.1.2 编写更新日志
  - [ ] 12.1.3 更新系统运行状态文档
  - [ ] 12.1.4 创建使用指南文档

- [ ] 12.2 用户通知
  - [ ] 12.2.1 在系统中添加新功能提示
  - [ ] 12.2.2 创建功能演示视频（可选）
