# OpenCode 桌面版使用指南

## 1. 启动和加载项目

### 打开项目
1. 启动 OpenCode 桌面版
2. 点击 "Open Folder" 或 "文件" → "打开文件夹"
3. 选择项目目录：`E:\python\stock\tickets-main`
4. 系统会自动读取 `opencode.json` 配置

### 验证配置加载
- 查看状态栏右下角，应显示：**Gemini 2.0 Flash**
- 或打开命令面板查看当前模型

---

## 2. 基本使用方法

### 方法 1: 右键菜单（最常用）

1. **选中代码或文本**
   - 鼠标拖动选中要分析的代码
   - 或选中股票数据、注释等

2. **右键点击**
   - 在选中的文本上右键
   - 选择 "Ask AI" 或 "询问 AI"
   - 或选择具体命令：
     - "解释代码"
     - "优化代码"
     - "生成注释"
     - "查找错误"

3. **查看结果**
   - AI 会在侧边栏或弹窗中显示回答
   - 可以直接复制或应用建议

### 方法 2: 命令面板

1. **打开命令面板**
   - 快捷键：`Ctrl+Shift+P` (Windows)
   - 或 `Cmd+Shift+P` (Mac)

2. **输入命令**
   - `Ask AI` - 询问 AI
   - `Explain` - 解释选中内容
   - `Refactor` - 重构代码
   - `Fix` - 修复错误
   - `Generate` - 生成代码

3. **输入你的问题**
   - 例如："分析这段股票筛选逻辑"
   - 或："优化这个函数的性能"

### 方法 3: 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+I` | 打开 AI 内联聊天 |
| `Ctrl+Shift+I` | 打开 AI 侧边栏 |
| `Ctrl+K` `Ctrl+I` | 解释选中内容 |
| `Ctrl+K` `Ctrl+F` | 修复选中代码 |
| `Ctrl+K` `Ctrl+G` | 生成代码 |
| `Ctrl+.` | 快速修复建议 |

---

## 3. 针对本项目的使用示例

### 示例 1: 分析股票数据

1. 打开 `backend/main.py`
2. 选中股票筛选函数：
   ```python
   def band_trading_screen(...)
   ```
3. 右键 → "Ask AI"
4. 输入：
   ```
   分析这个股票筛选函数的逻辑，检查是否有潜在问题
   ```

### 示例 2: 优化代码

1. 打开 `frontend/src/App.tsx`
2. 选中一段复杂的 useEffect
3. 右键 → "Refactor"
4. 或按 `Ctrl+K` `Ctrl+R`

### 示例 3: 生成注释

1. 选中一个函数
2. 输入命令：
   ```
   /doc 为这个函数生成详细的文档注释
   ```

### 示例 4: 解释报错

1. 如果代码有错误（红色波浪线）
2. 鼠标悬停在错误上
3. 点击 "Explain with AI"
4. 或按 `Ctrl+K` `Ctrl+E`

---

## 4. 切换模型

如果需要切换模型：

### 方法 1: 命令面板
1. `Ctrl+Shift+P`
2. 输入 "Select Model"
3. 选择：
   - `gemini-2.0-flash` (默认，免费额度充足)
   - `gemini-2.5-pro` (质量更高，但额度有限)

### 方法 2: 状态栏
1. 看右下角状态栏
2. 点击当前模型名称
3. 从下拉菜单切换

---

## 5. 高效使用技巧

### 技巧 1: 使用快捷指令

在 AI 输入框中输入：
- `/explain` - 解释代码
- `/refactor` - 重构代码
- `/fix` - 修复错误
- `/test` - 生成测试
- `/doc` - 生成文档
- `/optimize` - 优化性能

### 技巧 2: 上下文对话

- AI 会记住当前文件的上下文
- 可以连续提问，AI 会理解之前的对话
- 例如：
  1. "这个函数是做什么的？"
  2. "如何改进它的性能？"
  3. "给优化后的代码添加注释"

### 技巧 3: 批量处理

选中多个文件或整个文件夹：
1. 在文件资源管理器选中文件
2. 右键 → "Ask AI about selection"
3. 输入："分析这些文件的架构问题"

### 技巧 4: 代码对比

当 AI 建议修改时：
- 点击 "Show Diff" 查看差异
- 点击 "Apply" 应用修改
- 点击 "Copy" 复制建议
- 点击 "Discard" 放弃

---

## 6. 常见问题

### Q: 提示 "额度不足"
**解决**：切换到 `gemini-2.0-flash`，或等待第二天重置

### Q: 回复很慢
**解决**：
- 检查网络连接
- 减少一次发送的代码量
- 切换到更快的模型

### Q: 回答不够准确
**解决**：
- 提供更详细的上下文
- 指定具体的编程语言
- 说明你的具体需求

### Q: 如何查看剩余额度？
**解决**：
- 设置 → 账户 → 额度信息
- 或点击状态栏模型名称旁的额度指示器

---

## 7. 推荐工作流

### 日常开发流程

1. **写代码时**
   - 有想法但不确定实现 → `Ctrl+I` 问 AI
   - 遇到报错 → 悬停查看 → Explain with AI
   - 写完函数 → 选中 → /doc 生成注释

2. **重构时**
   - 选中旧代码 → /refactor
   - 查看 Diff → 选择性应用
   - 运行测试验证

3. **学习时**
   - 看到不熟悉的代码 → /explain
   - 询问最佳实践 → 直接输入问题
   - 生成示例代码 → /generate

---

## 8. 快捷命令速查表

| 你想做的 | 操作 |
|---------|------|
| 问 AI 问题 | `Ctrl+I` 或右键 Ask AI |
| 解释代码 | 选中 → `/explain` |
| 修复错误 | 选中 → `/fix` 或 `Ctrl+K Ctrl+F` |
| 重构代码 | 选中 → `/refactor` |
| 生成注释 | 选中 → `/doc` |
| 生成测试 | 选中 → `/test` |
| 优化性能 | 选中 → `/optimize` |
| 切换模型 | `Ctrl+Shift+P` → Select Model |

---

现在你可以开始使用 Gemini 2.0 Flash 免费额度进行开发了！🚀
